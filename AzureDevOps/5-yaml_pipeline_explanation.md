# ุชูุถุญ ูุงู azure-pipelines.yml

ุฏุฑ ุญู ุงูฺฉู Azure DevOps ูุงู YAML ุฑุง ูโุฎูุงูุฏ ู Pipeline ุฑุง ุงุฌุงุฏ ูโฺฉูุฏุ ุจุฏ ูุณุช ฺฉ ุชูุถุญ ฺฉุงูู ุงุฒ **ููุด ู ุณุงุฎุชุงุฑ ูุงู YAML ุฏุฑ CI/CD** ุฏุงุดุชู ุจุงุดู.

---

## ฑ๏ธโฃ ูุฏู ูุงู

- ุงู ูุงู ุจู Azure DevOps ูโฺฏูุฏ ฺฉู **ฺุทูุฑ ูพุฑูฺู ุฑุง Buildุ Test ู Publish ฺฉูุฏ**.
- ูุฑ ฺฉุงุฑ ฺฉู ุฏุฑ Pipeline ูุงุฒู ุงุณุช (ูุตุจ SDKุ ุจุงุฒุงุจ ูพฺฉุฌโูุงุ ุงุฌุฑุง ุชุณุชโูุงุ ุชููุฏ Artifact) ุฏุฑ ุงู ูุงู ุชุนุฑู ูโุดูุฏ.
- ุจุง ุงุณุชูุงุฏู ุงุฒ YAMLุ Pipeline **Version Control Friendly** ูโุดูุฏ ู ูโุชูุงูุฏ ุฏุงุฎู ุฑูพู ูฺฏูุฏุงุฑ ุดูุฏ.

---

## ฒ๏ธโฃ ุจุฎุดโูุง ุงุตู ูุงู

### 2.1 Trigger
```yaml
trigger:
  branches:
    include:
      - main
```
- ูุดุฎุต ูโฺฉูุฏ Pipeline **ฺู ุฒูุงู ุงุฌุฑุง ุดูุฏ**.
- ุฏุฑ ุงู ูุซุงูุ ูุฑ `push` ุง `merge` ุจู ุดุงุฎู `main` Pipeline ุฑุง ูุนุงู ูโฺฉูุฏ. ุนู ูุฑ ุจุงุฑ ฺฉู ุฏุฑ ุดุงุฎู main ุชุบุฑ Push ฺฉู (ฺฉุฏ ุฌุฏุฏุ ุชุบุฑ ูุงูุ ุญุช Commit ุฎุงู)ุ Azure DevOps ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ Pipeline ุฑู Run ูโฺฉูู. ูุงุฒ ูุณุช ูฺ ุฏฺฉููโุง ุจุฒู.

### 2.2 Pool
```yaml
pool:
  vmImage: 'ubuntu-latest'
```
- ุชุนุฑู ูโฺฉูุฏ ฺฉู **Agent ุฑู ฺู ุณุณุชู ุนุงูู ุงุฌุฑุง ุดูุฏ**.
- ุนู: "Azure DevOps ูุทูุงู ุจุฑุง ุงุฌุฑุง ุงู Pipeline ุงุฒ ฺฉ ูุงุดู ูุฌุงุฒ (Virtual Machine) ุจุง ุณุณุชูโุนุงูู Ubuntu (ุขุฎุฑู ูุณุฎูโ ูพุงุฏุงุฑ) ุงุณุชูุงุฏู ฺฉู."
- ุงู ูุงุดู ูุฌุงุฒ ุฏุฑ ุณุฑูุฑูุง Microsoft Azure ุงุฌุฑุง ูโุดูุฏ. ุนู ูุงุฒู ูุณุช ุฎูุฏุช ุณุฑูุฑ ุฑุงูโุงูุฏุงุฒ ฺฉู โ Azure DevOps ุฎูุฏุด ููฺฏุงู ุงุฌุฑุง Pipelineุ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉ VM (ูุงุดู ูุฌุงุฒ ูููุช) ุงุฌุงุฏ ูโฺฉูุฏุ ุฏุณุชูุฑุงุช ุชู ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ู ุจุนุฏ ุงุฒ ูพุงุงู ฺฉุงุฑ ุขู ุฑุง ูพุงฺฉ ูโฺฉูุฏ.
- `ubuntu-latest` ฺฉ ูุงุดู ูุฌุงุฒ ูููฺฉุณ ุงุณุช ฺฉู ุชูุงู ุงุจุฒุงุฑูุง ูุงุฒู ุจุฑุง .NET ูุตุจ ุดุฏู ุฏุงุฑูุฏ.
- ฺฉูููโ pool ุชุนู ูโฺฉูุฏ ฺฉู Pipeline ุฑู ฺู Agentโุง ุงุฌุฑุง ุดูุฏ. ุฏุฑ DevOpsุ ููุช ฺฉ Pipeline ุงุฌุฑุง ูโฺฉูุ ุฏุณุชูุฑูุง YAML (ูุซู buildุ test ู publish) ุจุงุฏ ุฑู ฺฉ ุณุณุชู ูุงูุน ุง ูุฌุงุฒ ุงุฌุฑุง ุดููุฏ. ุงู ุณุณุชู ุฑุง Build Agent ูโฺฏููุฏ.

### 2.3 Variables
```yaml
variables:
  buildConfiguration: 'Release'
  dotnetVersion: '9.0.x'
```
- ูุชุบุฑูุง ฺฉูฺฉ ูโฺฉููุฏ **ููุฏุงุฑูุง ุฑุง ฺฉุฌุง ุชุบุฑ ุฏู** ู ุฏุฑ ฺูุฏ ูุฑุญูู ุงุณุชูุงุฏู ุดููุฏ.
- ูุซุงู: Configuration ูพุฑูฺู (`Release` ุง `Debug`) ู ูุณุฎู SDK ุฏุงุชโูุช.

### 2.4 Steps
- ุดุงูู **ุฏุณุชูุฑุงุช ูุงูุน Build ู Test ู Publish** ุงุณุช.
- ูโุชูุงูุฏ `script` (ุฏุณุชูุฑ ุฎุท ูุฑูุงู) ุง `task` (ฺฉ Task ุขูุงุฏู Azure DevOps) ุจุงุดุฏ.

ูุซุงูโูุง ุฏุฑ ูุงู ูุง:
```yaml
- task: UseDotNet@2
  inputs:
    packageType: 'sdk'
    version: '$(dotnetVersion)'

- script: dotnet restore
- script: dotnet build --configuration $(buildConfiguration)
- script: dotnet test --logger "trx;LogFileName=test_results.trx"
- script: dotnet publish -o $(Build.ArtifactStagingDirectory)
- task: PublishBuildArtifacts@1
```
- `UseDotNet@2` โ ูุตุจ ูุณุฎู ูุดุฎุต SDK  
- `dotnet restore` โ ุจุงุฒุงุจ ูพฺฉุฌโูุง  
- `dotnet build` โ ุณุงุฎุช ูพุฑูฺู  
- `dotnet test` โ ุงุฌุฑุง ุชุณุชโูุง ูุงุญุฏ  
- `dotnet publish` โ ุฎุฑูุฌ ุจุฑุง ุงุณุชูุฑุงุฑ ุชููุฏ ูโฺฉูุฏ  
- `PublishBuildArtifacts@1` โ ุงูุชุดุงุฑ ุฎุฑูุฌ ุจู ุนููุงู Artifact ูุงุจู ุฏุงูููุฏ ุง Deploy

---

## ณ๏ธโฃ ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ YAML

- **Versioned**: ุฏุงุฎู Git ูฺฏูุฏุงุฑ ูโุดูุฏ  
- **Portable**: ูโุชูุงู ุจู ุฑุงุญุช Pipeline ุฑุง ุจู ูพุฑูฺูโูุง ููุชูู ฺฉู  
- **Readable**: ุฎูุงูุฏู ู ููู Pipeline ุณุงุฏู ุงุณุชุ ูุฎุตูุตุงู ููุช ุจุง ฺฉุงููุชโูุง ุชูุถุญ ุฏุงุฏู ุดูุฏ  
- **Flexible**: ูโุชูุงู ฺูุฏู Stageุ Job ู Task ุชุนุฑู ฺฉุฑุฏ

---

๐ก ุฎูุงุตู:  
ูุงู `azure-pipelines.yml` ุฏุฑ ูุงูุน **ููุดู ุฑุงู CI/CD ูพุฑูฺู ุชูุณุช**. Azure DevOps ุจุฑ ุงุณุงุณ ุงู ููุดู ูพุฑูฺู ุฑุง Buildุ Test ู Artifact ุชููุฏ ูโฺฉูุฏุ ู ูุฑ Push ุจู ุดุงุฎู `main` ุจุงุนุซ ุงุฌุฑุง ุฎูุฏฺฉุงุฑ Pipeline ูโุดูุฏ.

