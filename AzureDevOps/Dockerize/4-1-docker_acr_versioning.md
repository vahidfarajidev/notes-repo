ุฏุฑ ูุงู YAML:
```yaml
...
variables:
  dockerRegistryServiceConnection: 'AzureDemo-Connection'  # Service Connection ุจู Azure
  imageRepository: 'azuredemoapi'
  containerRegistry: '<ACR_NAME>' # ูุงู ACR
  tag: '1.0.0'
...
```
ุงฺฏุฑ ููุท ฺฉ ุชฺฏ ุซุงุจุช ุงุณุชูุงุฏู ฺฉู ูุซู `1.0.0` ุง ุญุช `latest` ู ูุฑ ุจุงุฑ Pipeline ุงุฌุฑุง ุดูุฏ:

* ููุงู Image ุฏุฑ ACR **ุจุงุฒููุณ ูโุดูุฏ** (overwrite).
* ูุณุฎู ูุจู ุงุฒ ุชฺฏ ููุงูโุฌุง ุญุฐู ุง ุฌุงฺฏุฒู ูโุดูุฏุ ูฺฏุฑ ุงูฺฉู ุชฺฏ ุฏฺฏุฑ ุฏุงุดุชู ุจุงุดุฏ.

---

### ุฑุงูฺฉุงุฑ ุฏุฑุณุช ุจุฑุง versioning

1. **ุงุณุชูุงุฏู ุงุฒ Semantic Versioning ุง Build ID**:
   ูุฑ ุจุงุฑ ฺฉู Pipeline ุงุฌุฑุง ูโุดูุฏุ ฺฉ ุชฺฏ ุฌุฏุฏ ุงุฌุงุฏ ฺฉู. ูุซุงูโูุง:

```yaml
tag: '1.0.0'           # ูุณุฎู ุซุงุจุช
tag: '1.0.$(Build.BuildId)'  # Build ID ุฎูุฏฺฉุงุฑ Azure DevOps
tag: 'ci-$(Build.BuildId)'   # CI-specific tag
```

2. **Pipeline Variables**:
   ูโุชูุงู ุฏุฑ Variables ุง ุฏุฑ Script YAML ฺฉ ุชฺฏ ูพูุง ุจุณุงุฒ ู ุงุณุชูุงุฏู ฺฉู:

```yaml
variables:
  tag: '$(Build.BuildId)'   # ูุฑ Build ุชฺฏ ุฌุฏุฏ
```

3. **Push ุจุง ฺูุฏ ุชฺฏ ููุฒูุงู** (ุงุฎุชุงุฑ):
   ฺฏุงู ูู ูโุชูู Image ุฑุง ุจุง `latest` ู ุจุง ุชฺฏ Build-specific Push ฺฉู ุชุง ูู ููุดู ุขุฎุฑู ูุณุฎู ูุดุฎุต ุจุงุดุฏ ู ูู History ูฺฏู ุฏุงุดุชู ุดูุฏ.

---

โ ุฌูุนโุจูุฏ:

* ุงฺฏุฑ ุชฺฏ ุซุงุจุช ุจุงุดุฏ โ ููุดู overwrite ูโุดูุฏ
* ุงฺฏุฑ ุชฺฏ ูพูุง ุจุงุดุฏ โ ูุณุฎูโูุง ูุฎุชูู ุญูุธ ูโุดููุฏ ู rollback ุฑุงุญุชโุชุฑ ุงุณุช
* 
  ---

## ูุฏุฑุช Docker Image ูุง ุฏุฑ ACR ู Azure App Service Free

ููุช ุฑู **Azure App Service Free/Shared** ฺฉุงุฑ ูโฺฉูู:

## 1. ฺฉ Container Image ููุท Deploy ูโุดูุฏ
- App Service ููุท ุขุฎุฑู Image ฺฉู Push ู Deploy ุดุฏู ุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏ.
- ูุณุฎูโูุง ูุจู ุฏุฑ ACR ุจุงู ูโูุงููุฏ ุงูุง ุฏุฑ App Service ููุท ูุณุฎู ุขุฎุฑ ูุนุงู ุงุณุช.

## 2. ูฺฏู ุฏุงุดุชู Imageโูุง ูุชุนุฏุฏ ุฏุฑ ACR
- **ACR** ูุญู ูฺฏูุฏุงุฑ Image ูุงุณุช.
- ูุฑ ุชฺฏ ุฌุฏุฏ Image ุฑุง ุฌุฏุง ูฺฏู ูโุฏุงุฑุฏ ู ุงูฺฉุงู rollback ูุฌูุฏ ุฏุงุฑุฏ.
- ุฑู App Service Freeุ ููุท ฺฉ ูุณุฎู Deploy ุดุฏู ูุนุงู ุงุณุช.

## 3. ุชูุตู ุจุฑุง ูพุฑูฺู ุชุณุช
- ูโุชูุงู ุงุฒ **ุชฺฏ ูพูุง ุจุฑุง versioning** ุงุณุชูุงุฏู ฺฉุฑุฏ (ูุซูุงู `ci-<BuildId>`).
- ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูพุฑ ุดุฏู ACR ุง ูุฒูู ุงุถุงููุ Imageูุง ูุฏู ุฑุง ูโุชูุงู ูพุงฺฉ ฺฉุฑุฏ:

```bash
# ูุณุช ุชฺฏโูุง
az acr repository show-tags --name <ACR_NAME> --repository azuredemoapi --output table

# ุญุฐู ุชฺฏ ูุฏู
az acr repository delete --name <ACR_NAME> --repository azuredemoapi --tag <old-tag> --yes
```

## ๐ก ุฌูุนโุจูุฏ

- ุฑู **App Service Free**ุ Deploy ููุดู ฺฉ Image ุงุณุช โ ุณุฑูุฑ ุงุดุบุงู ููโุดูุฏ.
- ุฏุฑ **ACR** ูุณุฎูโูุง ูุชุนุฏุฏ ุจุงู ูโูุงููุฏ โ ุงูฺฉุงู rollback ูุฌูุฏ ุฏุงุฑุฏ.
- ุจุฑุง ูพุฑูฺู ุชุณุช โ ูโุชูุงู ฺูุฏ Build ุณุงุฎุช ู ุจุนุฏ ุชฺฏโูุง ูุฏู ุฑุง ูพุงฺฉ ฺฉุฑุฏ ุชุง ูุญุท ุชูุฒ ุจูุงูุฏ.

---

### ูฺฉุชู ุงุฎุชุงุฑ:
ูโุชูุงู ฺฉ **Pipeline ุจุง Cleanup ุงุชููุงุชฺฉ ุชฺฏโูุง ูุฏู ACR** ุณุงุฎุช ุชุง ููุดู ูุญุท ูุฑุชุจ ุจุงุดุฏ ู ูุณุฎูโูุง ูุฏู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุญุฐู ุดููุฏ.



